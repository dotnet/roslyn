<Project InitialTargets="IntegrateTeamcity">

    <!-- TeamCity integration -->
    <PropertyGroup Condition=" '$(ContinuousIntegrationBuild)' == '' ">
        <!-- Copied from TeamCity.VSTest.TestAdapter package. -->
        <ContinuousIntegrationBuild Condition=" '$(TEAMCITY_PROJECT_NAME)' != '' Or '$(TEAMCITY_VERSION)' != '' ">True</ContinuousIntegrationBuild>
    </PropertyGroup>

    <Target Name="IntegrateTeamcity" Condition="'$(ContinuousIntegrationBuild)' == 'True'">
        <ItemGroup>
            <IsTestSdkReferenced Include="@(PackageReference)" Condition="'%(Identity)'=='Microsoft.NET.Test.Sdk'" />
        </ItemGroup>

        <ItemGroup>
            <PackageReference Include="TeamCity.Dotnet.Integration" Version="1.0.18">
                <PrivateAssets>all</PrivateAssets>
                <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
            </PackageReference>
            <PackageReference Include="TeamCity.VSTest.TestAdapter" Version="1.0.26" Condition="'@(IsTestSdkReferenced)'!=''" />
        </ItemGroup>
    </Target>

</Project>